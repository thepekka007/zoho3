{% extends 'base.html' %}
{% block content %}
{% load static %}


<style>
  .bg-dark {
    --bs-bg-opacity: 0;
    background-color: rgba(var(--bs-dark-rgb), var(--bs-bg-opacity)) !important;
}
.table-striped>tbody>tr:nth-of-type(odd)>* {
    --bs-table-accent-bg: black;
    color: var(--bs-table-striped-color);
}
</style>
<style>
  .bg-dark {
    --bs-bg-opacity: 0;
    background-color: rgba(var(--bs-dark-rgb), var(--bs-bg-opacity)) !important;
}
.table-striped>tbody>tr:nth-of-type(odd)>* {
    --bs-table-accent-bg: black;
    color: var(--bs-table-striped-color);
}
a {
  color: rgb(255, 251, 251); /* You can use any color you prefer */
  text-decoration: none; /* Optional: Remove underline if you don't want it */
}
</style>

<div class="body-wrapper" >  
  <div class="container-fluid" >

      <!-- ADD ITEM FORM -->
      <div style="background-color: black; border-radius: 10px;width: 100%;" >
      <BR>
              <h3 class="mb-3 text-white mt-4" style="font-size: 2rem;margin-left: 40PX;">All Items</h3>
     <br>
     <div class="row container-fluid mb-3">
      <div class="col-md-3">
        <input type="text" id="myyInput" onkeyup="myyFunction()" class="form-control bg-light text-dark"
          placeholder="Search.." autocomplete="off" style="margin-left: 40px;">
      </div>
      <div class="col-md-2">
        <div class="dropdown">
          <a class="btn text-center px-4 pt-2 btn-outline-warning" id="sortbutton" data-bs-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false" role="button" style="margin-left: 36px;">
            <i class="fas fa-sort m-1"></i>
          </a>
          <div class="dropdown-menu m-1" style="background-color: black; color: white;">
            <a class="dropdown-item" href="" style="background-color: black; color: white;">All</a>
            <a class="dropdown-item" href="javascript:void(0);" onclick="handleDropdownItemClick(1)" style="background-color: black; color: white;">Item Name</a>
            <a class="dropdown-item" href="javascript:void(0);" onclick="handleDropdownItemClick(2)" style="background-color: black; color: white;">HSN</a>
            
            <!--<a class="dropdown-item" onclick="sortTableTotal()">Total</a>-->
          </div>
        </div>
      </div>
      <div class="col-md-4" style="padding-left: 240px;">
      <div class="col-md-3">
        <div class="dropdown d-flex">
          <a class="btn text-center px-4 pt-2 btn-outline-warning" data-bs-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false" role="button">
            <i class="fa fa-filter mt-1"></i>
          </a>
          <div class="dropdown-menu m-1" style="background-color: black; color: white;">
            <a class="dropdown-item dropdown-item-filter" href="javascript:void(0);" style="background-color: black; color: white;">All</a>
            <a class="dropdown-item dropdown-item-filter" href="javascript:void(0);" style="background-color: black; color: white;">Active</a>
            <a class="dropdown-item dropdown-item-filter" href="javascript:void(0);" style="background-color: black; color: white;">Inactive</a>
          </div>
          
          <a style="border: 1px solid; border-radius: 5px; height: 2.9rem; display: flex; align-items: center;margin-left: 10px;" onclick="reduce_dash()" data-bs-toggle="modal" data-bs-target="#exampleModal" class="btn btn-outline-warning"  href="">
            <i class="fa fa-file-excel-o p-1" style="font-size: large;"></i>
            <span style="font-size: 2vh; margin-left: 0.5rem;" class="text-center">Import</span>
        </a>
        <a style="border: 1px solid; border-radius: 5px; height: 2.9rem; display: flex; align-items: center;margin-left: 10px;" onclick="exportToExcel()"0 class="btn btn-outline-warning" >
          <i class="fa fa-file-excel-o p-1" style="font-size: large;"></i>
          <span style="font-size: 2vh; margin-left: 0.5rem;" class="text-center">Export</span>
      </a>
      <a style="border: 1px solid; border-radius: 5px; height: 2.9rem; display: flex; align-items: center;margin-left: 10px;" class="btn btn-outline-warning" href="">
        <i class="fa fa-plus" style="font-size: large;"></i>
        <span style="font-size: 2vh; margin-left: 0.5rem;" class="text-center"></span>
    </a>
        </div>
      </div>
    </div>
    <br>
    
<div class="container-fluid" id="container-to-print"> 
  <section id="selected-area">
<div class="row pt-5">
    <center>


    </center>
    <div class="table-responsive"> 
    <table class="table table-bordered table-striped mt-4" id="data-table">
      <thead class="text-white">
        
          <tr>
              <th style="color: rgb(247, 247, 247);">No.</th>
              <th style="color: rgb(250, 247, 242);">Name</th>
              <th style="color: rgb(244, 244, 244);">HSN</th>
              <th style="color: rgb(255, 255, 255);">Sales Rate</th>
              <th style="color: rgb(252, 252, 252);">Purchase Rate </th>
              <th style="color: rgb(237, 237, 236);">Stock on Inventory </th>
              <th style="color: rgb(247, 245, 240);">Balance Stock</th>
              <th style="color: rgb(251, 251, 251);">STATUS</th>
              
          </tr>
      </thead>
    <tbody style="background-color: black;">
      
      {% for i in item %}
    <tr style="background-color: black;" class='clickable-row' data-href="{% url 'itemsoverview' i.id%}">             
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id%}">{{ i.item_name }}</td>
      <!-- <td style="color: rgb(0, 0, 0); background-color: black;">{{ i.type }}</td> -->
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.hsn_code }}</a></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.selling_price }}</a></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.purchase_price }}</a></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.opening_stock }}</a></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.minimum_stock_to_maintain }}</a></td>
      <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'itemsoverview'  i.id %}">{{ i.activation_tag }}</a></td>
  </tr>
{% endfor %}

  
    </tbody>
                              
    </table> 
    {% comment %} <div id="total-bill-amount" class="mt-3" style="color: white;"></div> {% endcomment %}
    <div>
        <div id="noDataMessage" style="display: none; color: white;">No data found for selected dates.</div>	
        <br><br><br><br><br>
    </div>
</div>
</div>
</section>


</div>
      </div>
  </div>
</section>
<!-- TABLE SORT SCCCRIPT -->
<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Your existing HTML code -->

<script>
  // Function to sort the table based on the selected column
  function sortTable(columnIndex) {
    var table, rows, switching, i, x, y, shouldSwitch;
    table = document.getElementById("data-table");
    switching = true;

    while (switching) {
      switching = false;
      rows = table.getElementsByTagName("tr");

      for (i = 1; i < rows.length - 1; i++) {
        shouldSwitch = false;
        x = rows[i].getElementsByTagName("td")[columnIndex];
        y = rows[i + 1].getElementsByTagName("td")[columnIndex];

        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          shouldSwitch = true;
          break;
        }
      }

      if (shouldSwitch) {
        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
        switching = true;
      }
    }
  }

  // Function to handle dropdown item click
  function handleDropdownItemClick(index) {
    sortTable(index);
  }

  // Attach click event listeners for sorting Name and HSN columns
  $(document).ready(function () {
    $(".dropdown-item").click(function () {
      // Get the index of the clicked dropdown item
      var index = $(this).index();
      
      // Call the handleDropdownItemClick function with the index
      handleDropdownItemClick(index);
    });
  });
</script>

<!-- END SORT SCRIPT -->


<!-- filter script -->

<script>
  // Function to filter the table based on the selected status
  function filterTable(status) {
    var table, rows, i;
    table = document.getElementById("data-table");
    rows = table.getElementsByTagName("tr");

    for (i = 1; i < rows.length; i++) {
      var rowStatus = rows[i].lastElementChild.textContent.trim(); // Assuming status is in the last column

      if (status === "All" || rowStatus === status) {
        rows[i].style.display = "";
      } else {
        rows[i].style.display = "none";
      }
    }
  }

  // Function to handle dropdown item click for filtering
  function handleFilterDropdownItemClick(status) {
    filterTable(status);
  }

  // Attach click event listeners for filtering
  $(document).ready(function () {
    $(".dropdown-item-filter").click(function () {
      var status = $(this).text().trim();
      // Call the handleFilterDropdownItemClick function with the selected status
      handleFilterDropdownItemClick(status);
    });
  });
</script>

<!-- filter End -->
{% endblock %}