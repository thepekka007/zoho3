{% extends 'base.html' %}
{% block content %}
{% load static %}
<script src="https://raw.githack.com/eKoopmans/html2pdf/master/dist/html2pdf.bundle.js"></script>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha384-ez8n5b/9F3JpKCEY6zIp+Hg7IbU8d7Q5ST78iEiRaP2mNPjkDps8I+1i0fblDOoh" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>

<style>
   .modal {
    z-index: 9999;
    overflow: scroll;
  }

  .modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
  }

  /* Add your CSS styles here */
  /* Styling for the filter input window */
/* Styling for the filter input window */
.filter-window {
  display: none;
  position: absolute;
  padding: 10px;
  color: aliceblue;
  width: 10%;
  background-color: rgb(37, 105, 99);
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  z-index: 1; /* Ensures the window is on top */
}

/* Additional styling for the filter input */
.filter-window label, .filter-window input, .filter-window button {
  display: block;
  margin-bottom: 5px;
}
.filter-window button {
    display: inline-block;
    margin-right: 5px;
    padding: 5px 10px;
    background-color: #4CAF50; /* Green background color */
    color: white; /* White text color */
    border: none; /* Remove border */
    border-radius: 3px; /* Optional: Add rounded corners */
    cursor: pointer; /* Add a pointer cursor on hover */
}

.filter-window button:hover {
    background-color: #45a049; /* Darker green on hover */
}

</style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"> -->
  <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script> -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script> -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-xxxxxx" crossorigin="anonymous" />

<div class="body-wrapper" style="margin-left: 0; width: 100%;">

    <div class="container-fluid" style="width: 100%; margin: 0 auto;">

        <div class="col-md-12" style="width: 120%;">
            <div class="row">
              <div class="col-md-3" style="border-right: 1px solid white; overflow-y: scroll; height: 84vh;">
                <div class="row">
                  <a class="text-white" style="font-size: 1.5rem;">All Items</a>
               
                  <br>      
               
              <div class="col-md-2 mt-2 mx-1">
                <a id="sort-button" class="btn btn btn-outline-warning text-right mt-2 fa fa-sort px-3" style="height: 30px;background-color: #262525;" data-bs-toggle="dropdown" role="button"></a>&nbsp;&nbsp;&nbsp;
                <div class="dropdown-menu text-white " style="background-color: #262525;" >
                    <a class="dropdown-item text-white" href="{% url 'itemsoverview' selitem.id %}">All</a>
                    <a class="dropdown-item text-white" href="{% url 'item_view_sort_by_name' selitem.id %}">Item Name</a>
                    <a class="dropdown-item text-white" href="{% url 'item_view_sort_by_hsn' selitem.id %}">HSN</a>
                </div>
            </div>
              <div class="col-md-3   ">
                <div class="col-md-2  mt-2 mx-1">
                    <a class="btn btn btn-outline-warning text-right mt-2 fa fa-filter" style="height: 30px;" data-bs-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                    </a>
                    <div class="dropdown-menu "  style="background-color: #262525;">
                        <a class="dropdown-item text-white" href="{% url 'itemsoverview' selitem.id %}">All</a>
                        <a class="dropdown-item text-white" href="{% url 'filter_item_view_Active' selitem.id %}">Active</a>
                        <a class="dropdown-item text-white" href="{% url 'filter_item_view_inActive' selitem.id %}">Inactive</a>
                    </div>
                 <!-- </div> -->

                </div>
             
                  
           
                </div>
                  <div class="col-md-3 ">
                    <div class="col-md-2  mt-2 mx-1">
                    <a class="btn btn btn-outline-warning text-right mt-2 fa fa-plus" style="height: 30px; " href="{% url 'new_items' %}"></a>
                  </div>
                  </div>
             
    
                </div>
    
                <div class="scrollable-table" style="width: 100%;">
                  <div class="row">
                    <div class="col-md-12">
                      <input type="text"  id="searchInput" class="form-control text-white" style="border-color: rgb(198, 134, 16);" placeholder="Search...">


                    </div>
                </div>
    <br>
           
              
           
              <!-- Table 2: Billable Projects -->
              <table id="table2" class="table customer-table" style="border: 1px solid black; width: 100%; margin-left: 0;color: #d19d0d;">
                <tbody>
                  {% for i in items %}
                         <!-- <td>
                      <a class="text-white"  href="{% url 'itemsoverview'  i.id%}"><b>{{i.item_name}}</b> <span class="d-flex justify-content-end text-warning align-items-start" > {{i.current_stock}}</span> <br>
                          <span class="d-flex  align-items-start text-warning"> {{i.hsn_code}}</span> <span class="d-flex justify-content-end align-items-start"> {{i.activation_tag}}</span>
                      </a>   
                  </td> -->
                  
                  <tr class="account-row" data-account-type="{{ i.account_type }}">
                  <td>   <a href="{% url 'itemsoverview' i.id %}" style="  text-decoration: none;
                    color: rgb(224, 158, 16);"> {{ i.item_name }}</a></td>
                    <td><a href="{% url 'itemsoverview' i.id %}" style="  text-decoration: none;
                      color: rgb(224, 158, 16);">{{ i.current_stock }}</a></td> 
                  </tr> 
                  <tr class="account-row" data-account-type="{{ i.account_type }}">
                    <td><a href="{% url 'itemsoverview' i.id %}" style="  text-decoration: none;
                      color: rgb(224, 158, 16);">{{ i.hsn_code }}</a><hr style="width: 200%;margin-left: -10px;color: #ffffff;">  </td>
                    <td><a href="{% url 'itemsoverview' i.id %}" style="  text-decoration: none;
                      color: rgb(224, 158, 16);">{{ i.activation_tag }} </a><hr style="width: 200%;margin-left: 1px;color: #ffffff;"> </td>
                    
                  </tr>
              
                  {% endfor %}
                </tbody>
              </table>
              

    </div>
</div>




<div class="col" style="width: 300%;" id="overviewdiv" style="display: block;">
    <div class="row">
      <div class="col-md-7">
        <a class="text-white" style="font-size: 1.5rem;">
          <h2 style="color: aliceblue;">{{selitem.item_name}}</h2>
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <a class="btn" style="background-color: chocolate; margin-right: 2vh;color: aliceblue;"><i class="fas fa-eye"></i>
          Overview</a>
          <a class="btn" style="background-color: rgb(15, 13, 120); margin-right: 2vh;color: aliceblue;" onclick="totemplate()"><i class="fas fa-eye"></i>
            Transaction</a>
            <script>
              document.addEventListener('DOMContentLoaded', function() {
                  // Get the elements by ID
                  var overviewDiv = document.getElementById('overviewdiv');
                  var transactionDiv = document.getElementById('Transaction');
          
                  // Set the initial display state
                  overviewDiv.style.display = 'block';
                  transactionDiv.style.display = 'none';
              });
          
              function totemplate() {
                  // Get the elements by ID
                  var overviewDiv = document.getElementById('overviewdiv');
                  var transactionDiv = document.getElementById('Transaction');
          
                  // Toggle the display property
                  if (overviewDiv.style.display === 'block' || overviewDiv.style.display === '') {
                      overviewDiv.style.display = 'none';
                      transactionDiv.style.display = 'block';
                  } else {
                      overviewDiv.style.display = 'block';
                      transactionDiv.style.display = 'none';
                  }
              }
              function totemplate2() {
        // Get the elements by ID
        var overviewDiv = document.getElementById('overviewdiv');
        var transactionDiv = document.getElementById('Transaction');

        // Show the overviewDiv and hide the transactionDiv
        overviewDiv.style.display = 'block';
        transactionDiv.style.display = 'none';
    }
          </script>
          


      </div>

      <div class="col-md-6" style="text-align: center;">

       
        <a href="{% url 'edititems'  selitem.id%}"  title="save this draft" >
    </a>

   
  
         
    </div>
    </div><br>

    <div class="row" id="div-to-pdf"
      style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">

      <div class="row text-center">
        <h2 style="color: #000000;"><br>{{selitem.item_name}}
          <hr>
        </h2>
      </div>    
      <div class="row" id="div-to-pdf"
      style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">

      
      <div class="gen-info col-6 " style="padding-left: 3rem; ">
        <div class="row mt-1">
          <div class="col-5"><label class="text-dark" for="">Item Type:</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.item_type}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">HSN Code:</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">   {{selitem.hsn_code}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Unit :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              {{selitem.unit.unit_name}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Tax Preference :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              {{selitem.tax_reference}}</p>
          </div>
        </div>
        {% if selitem.tax_reference == "taxable" %}
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Intrastate Tax :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              GST{{selitem.intrastate_tax}}%</p>
          </div>
        </div>
  
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Interstate Tax :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  CGST{{selitem.interstate_tax}}%</p>
          </div>
        </div>
        {% endif %}
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Status :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">         {{selitem.activation_tag}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for=""> Minimum Stock To Maintain :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">        {{selitem.minimum_stock_to_maintain}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Inventory Account : </label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.inventory_account}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Opening stock :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.opening_stock}}</p>
          </div>
        </div>
      
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Current Stock :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  {{selitem.current_stock}}</p>
          </div>
        </div>
      </div>
     
      
      <div class="p-info col-6 text-white" style="height: 100%; margin-bottom: 1vh;">
        <div class="card text-white" style="background-color: rgb(110, 61, 46); padding-left: 1rem; padding-top: 1rem;">
          <div class="row text-center">
            <h2 class="text-white">PURCHASE DETAILS {{latest_item_id.action}}
              <hr>
            </h2>
          </div>


          <div class="row mt-2 text-white" >
            <div class="col-5"><label for="">Purchase Price :</label></div>
            <div class="col-7">
              <p class="bold"> {{selitem.purchase_price}}</p>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-5"><label for="">Purchase Account :</label></div>
            <div class="col-7">
              <p class="bold">  {{selitem.purchase_account}}  </p>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-5"><label for=""> Purchase Description :</label></div>
            <div class="col-7">
              <p class="bold">  {{selitem.purchase_description}} </p>
            </div>
          </div>

<br>
            
            

   
    <div class="row text-center">
      <h2 class="text-white">SELLING DETAILS
        <hr>
      </h2>
    </div>



      <div class="row mt-2">
        <div class="col-5"><label for=""> Selling Price :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.selling_price}} </p>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-5"><label for=""> Sales Account :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.sales_account}} </p>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-5"><label for=""> Sales Description :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.sales_description}} </p>
        </div>
      </div>
</div>
</div>
</div>
    </div>
    </div>

    <div class="col" style="width: 300%;" id="Transaction" style="display: none;">
      <div class="row">
        <div class="col-md-7">
          <a class="text-white" style="font-size: 1.5rem;">
            <h2 style="color: aliceblue;">{{selitem.item_name}}</h2>
          </a>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <a class="btn" style="background-color: chocolate; margin-right: 2vh;color: aliceblue;" onclick="totemplate2()"><i class="fas fa-eye"></i>
            Overview</a>
            <a class="btn" style="background-color: rgb(15, 13, 120); margin-right: 2vh;color: aliceblue;" onclick="totemplate()"><i class="fas fa-eye"></i>
              Transaction</a>
   
  
  
        </div>
        <div class="col-sm-1 ">
          <div class="col-md-6 d-flex justify-content-between align-items-center">
      
              <!-- Edit Button -->
              <a href="{% url 'edititems'  selitem.id%}" class="btn btn-outline-warning py-2 text-warning" title="Save this draft">
                  <i class="fas fa-pencil-alt"></i>
              </a>
      
              <!-- Item Status Edit Button -->
              <a href="{% url 'item_status_edit' selitem.id %}" class="btn btn-outline-warning py-2" title="Save this draft" style="margin-left: 4px;">
                  {{selitem.activation_tag}}
              </a>
      
              <!-- Delete Button -->
              <a href="{% url 'deleteitem'  selitem.id%}" class="delete fa fa-trash btn btn-outline-warning text-warning px-2 py-2"
                  data-toggle="tooltip" title="DELETE" onclick="return confirm('Do you want to Delete this creditnote?');" style="margin-left: 4px;"></a>
      
              <!-- Share Button -->
              <div class="dropdown px-2 py-4">
                  <a class="btn text-center  btn-outline-warning" id="sortbutton" data-bs-toggle="dropdown" role="button" style="margin-left: 4px;">
                      <i class="fas fa-share"></i>
                  </a>
                  <div class="dropdown-menu m-1" style="background-color: rgb(43, 42, 42); color: white;margin-left: 4px;">
                      <a class="dropdown-item" data-toggle="modal" data-target="#shareBillEmail" href="#" style="color: #eeeaea;">GMAIL</a>
                      <a class="dropdown-item" href="javascript:void(0);" onclick="shareOnWhatsApp()" style="color: #fefefe;">WhatsApp</a>
                  </div>
              </div>
      
              <a class="text-dark" onclick="exportToPDF3()">
                  <button class="btn btn-outline-warning" title="Pdf" style="width: 50px;margin-left: 4px;"><i class="fas fa-file-pdf" ></i></button>
              </a>
      
              <a class="btn btn-outline-warning py-2" style="cursor: pointer;margin-left: 4px;" onclick="exportToExcel()" style="width: 50px;margin-left: 4px;">XLS</a>
      
              <a class="text-dark" onclick="printSelectedArea2()">
                  <button class="btn btn-outline-warning" title="Print" style="width: 50px;margin-left: 4px;"><i class="fas fa-print" ></i></button>
              </a>
      
              <!-- Comment Button -->
              <div class="dropdown">
                  <a href=" " class="btn btn-outline-warning py-2 fas fa-comment-dots dropdown-toggle text-warning"
                      data-bs-toggle="dropdown" id="attachmentDropdown" aria-haspopup="true" aria-expanded="false" style="margin-left: 4px;"></a>
                  <div class="dropdown-menu" aria-labelledby="attachmentDropdown" style="background-color: rgb(46, 45, 45); color: white;margin-left: 4px;">
                      <a class="dropdown-item text-white" style="cursor: pointer;" data-toggle="modal" data-target="#cmnts"><i
                              class="fa-solid fa fa-plus"></i>Add</a>
                      <a class="dropdown-item text-white" style="cursor: pointer;" data-toggle="modal" data-target="#cmt_list"><i
                              class="fas fa-list"></i>&nbsp;View List</a>
                  </div>
              </div>
      
              <!-- History Button -->
              <a class="btn btn-outline-warning py-2" style="cursor: pointer;margin-left: 4px;" data-toggle="modal" data-target="#history" >History</a>
          </div>
      </div><br>
      
  
      <div class="row" id="div-to-pdf"
        style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">
  
        <div class="row text-center">
          <h2 style="color: #000000;"><br>{{selitem.item_name}}
            <hr>
          </h2>
        </div>    
        <div class="row" id="div-to-print"
        style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">
        <div class="row mt-3">
          <div class="col-md-6">
              <label class="text-dark bold" for="">Item Name:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{selitem.item_name}}</p>
          </div>
          <div class="col-md-6">
              <label class="text-dark bold text-dark" for="">Selling Price:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{selitem.selling_price}}</p>
          </div>
      </div>
      
      <div class="row mt-3">
          <div class="col-md-6">
              <label class="text-dark" for="">Purchase Price:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{selitem.purchase_price}}</p>
          </div>
          <div class="col-md-6">
              <label class="text-dark" for="">Minimum Stock To Maintain:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{selitem.minimum_stock_to_maintain}}</p>
          </div>
      </div>
      
      <div class="row mt-3">
          <div class="col-md-6">
              <label class="text-dark" for="">Stock Quantity:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{selitem.opening_stock}}</p>
          </div>
          <div class="col-md-6">
              <label class="text-dark" for="">Stock Value:</label>
              <p class="bold text-dark d-inline" style="max-width: 15rem; word-wrap: break-word; font-weight: bold;">{{stock_value}}</p>
          </div>
      </div>
      
  
  <style>
    .dashed-line {
      border-top: 1px dashed #000; /* Set color and style */
      margin: 20px 0; /* Adjust margin for spacing */
    }
  </style>
  
  <div class="dashed-line"></div>

  <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Search ..." style="width: 13%; border-radius: 5px;"> 
  <br><br>
  
  <table class="table table-hover table-bordered" id="table1" style="border-color: #000000;color: rgb(0, 0, 0);">
    <thead>
      <tr>
        <th id="th" style="text-align: center;">Transactions <i class="fas fa-filter m-1" onclick="showFilter('Transactions')"></i></th>
        <th id="th" style="text-align: center;">Type <i class="fas fa-filter m-1" onclick="showFilter('Type')"></i></th>
        <th id="th" style="text-align: center;">Name <i class="fas fa-filter m-1" onclick="showFilter('Name')"></i></th>
        <th id="th" style="text-align: center;">Date <i class="fas fa-filter m-1" onclick="showFilter('Date')"></i></th>
        <th id="th" style="text-align: center;">Quantity <i class="fas fa-filter m-1" onclick="showFilter('Quantity')"></i></th>
        <th id="th" style="text-align: center;">Price <i class="fas fa-filter m-1" onclick="showFilter('Price')"></i></th>
        <th id="th" style="text-align: center;">Status <i class="fas fa-filter m-1" onclick="showFilter('Status')"></i></th>
      </tr>
    </thead>
    <tbody>
      <tr style="color: black;">
        <td style="text-align: center;"></td>
        <td style="text-align: center;"></td>
        <td style="text-align: center;"></td>
        <td style="text-align: center;"></td>
        <td style="text-align: center;">{{selitem.opening_stock}}</td>
        <td style="text-align: center;"></td>
        <td style="text-align: center;"></td>
      </tr>
      <!-- Add more rows as needed -->
    </tbody>
  </table>
  
  <script>
  function searchTable() {
    // Declare variables
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("searchInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("table1");
    tr = table.getElementsByTagName("tr");
  
    // Loop through all table rows, and hide those that don't match the search query
    for (i = 0; i < tr.length; i++) {
      td = tr[i].getElementsByTagName("td")[0]; // Adjust index based on the column you want to search
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
      }
    }
  }
  </script>
<div id="filterWindow" class="filter-window">
  <!-- <label for="filterInput">Enter filter text:</label> -->
  <input type="text" id="filterInput">
  <button onclick="applyFilter()">Apply</button>
  <button onclick="clearFilter()">Clear</button>
</div>
  <script>
    function clearFilter() {
    document.getElementById('filterInput').value = '';
    // Implement your logic to clear the filter and update the table accordingly
    // For simplicity, you can just log the action to the console
    console.log('Filter Cleared');
    // Close the filter window
    document.getElementById('filterWindow').style.display = 'none';
}

    // JavaScript functions
    function showFilter(columnName, thElement) {
    var filterWindow = document.getElementById('filterWindow');
    filterWindow.style.display = 'block';
    
    // Set the position of the filter window near the th element
    var thRect = thElement.getBoundingClientRect();
    filterWindow.style.top = thRect.bottom + 'px';
    filterWindow.style.left = thRect.left + 'px';

    // You can customize the filter window based on the column clicked
    // For simplicity, I'm setting the label text to the column name
    filterWindow.querySelector('label').innerText = 'Enter filter text for ' + columnName + ':';
}

</script>
    <div class="row mt-3">
      <div class="col-5"><label class="text-dark" for=""> </label></div>
      <div class="col-7">
        <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-5"><label class="text-dark" for=""> </label></div>
      <div class="col-7">
        <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-5"><label class="text-dark" for=""> </label></div>
      <div class="col-7">
        <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  </p>
      </div>
    </div>
  </div>
  </div>
      </div>
      </div>
  </div>  </div>

         
<!-- SORT  AND FILTER SCRIPT -->
<script>
    $(document).ready(function() {
        // Event listener for dropdown menu links
        $('.dropdown-item-filter-account-type').click(function() {
            // Get the selected account type
            var selectedType = $(this).text().toLowerCase();
    
            // Show/hide table rows based on the selected account type
            $('.account-row').each(function() {
                var accountType = $(this).data('account-type').toLowerCase();
                if (selectedType === 'all' || accountType === selectedType) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        });
    });

    $(document).ready(function() {
    // Initialize DataTable
    var table = $('#table2').DataTable({
        "paging": false, // Disable pagination if not needed
        "order": [[0, "asc"]], // Initial sorting by the first column (change as needed)
    });

    // Event listener for dropdown menu links
    $('.dropdown-item-filter-account-type').click(function() {
        // ... (your existing filtering logic)

        // Refresh DataTable after filtering
        table.draw();
    });

    // Event listener for sorting dropdown menu link
    $('.dropdown-item-sort').click(function() {
        var columnIndex = $(this).data('column-index');

        // Toggle between ascending and descending order
        var order = table.order()[0];
        if (order[0] === columnIndex) {
            order[1] = order[1] === 'asc' ? 'desc' : 'asc';
        } else {
            order = [columnIndex, 'asc'];
        }

        // Apply sorting
        table.order(order).draw();
    });
});
    </script>
    
  <!-- share sccripts -->
<script>
   function shareOnWhatsApp() {
    var url = window.location.href;
    var text = url;
    text = encodeURIComponent(text);
    var whatsappUrl = "whatsapp://send?text=" + text;
    window.location.href = whatsappUrl;
  }

</script>

<!-- print and pdf  and xcel scripts -->


<script>
function printSelectedArea2(area) {
  // Get the HTML content of the table
  var printContents = document.getElementById("table1").innerHTML;

  // Open a new window
  var printWindow = window.open('', '_blank');

  // Add styles to hide specific elements during printing
  printWindow.document.write('<style>@media print { #searchInput, #filterWindow { display: none; } }</style>');

  // Add additional styles for the table layout
  printWindow.document.write('<style>table { border-collapse: collapse; width: 100%; }</style>');
  printWindow.document.write('<style>table, th, td { border: 1px solid black; }</style>');

  // Write the HTML content to the new window
  printWindow.document.write('<html><head><title>Print Data</title></head><body>');
  printWindow.document.write(document.getElementById('div-to-print').innerHTML);
  printWindow.document.write('</body></html>');

  // Print the new window
  printWindow.print();
}


  function exportToPDF3() {
  var content = document.getElementById('div-to-print');
  
  // Apply styles to the content
  var originalDisplayStyle = searchInput.style.display;

// Hide the search input temporarily
searchInput.style.display = 'none';
  content.style.backgroundColor = 'white';
  content.style.color = 'black';


  var heading = document.createElement('h1');
  heading.textContent = '{{selitem.item_name}}' + '  ' + 'Transactions';
  heading.style.textAlign = 'center';  // Center the heading
  heading.style.marginTop = '50px';    // Add top margin for better spacing
  heading.style.marginBottom = '20px'; 
  content.insertBefore(heading, content.firstChild); 
  // Apply styles to h1 elements within the content
  var h1Elements = content.getElementsByTagName('h1');
  for (var i = 0; i < h1Elements.length; i++) {
    h1Elements[i].style.color = 'black';
  }

  // Generate PDF using html2pdf
  html2pdf()
    .from(content)
    .save('{{selitem.item_name}}' + '.pdf');
}
function exportToExcel() {
    var table = document.querySelector('#table1'); // Add # to select by ID
    var ws = XLSX.utils.table_to_sheet(table);
    var wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    XLSX.writeFile(wb, 'item.xlsx');
}

</script>

<!-- MOdal EMAIL -->

<div class="modal fade" id="shareBillEmail">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
        <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #fefefe;">Share Item Transactions Via Email</h5>
        <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="{% url 'shareItemToEmail' selitem.id %}" method="post" class="needs-validation"
            id="share_to_email_form" autocomplete="off">
            {% csrf_token %}
            <div class="form-group">
              <label for="emailIds" style="color: #000;">Email IDs</label>
              <textarea class="form-control text-dark"  style="color: #000;" name="email_ids" id="emailIds" rows="5"
                placeholder="Multiple emails can be added by separating with a comma(,)." required></textarea>
            </div>
            <div class="form-group mt-2">
              <label for="item_unitname"  style="color: #000;">Message(optional)</label>
              <textarea name="email_message"  style="color: #000;" id="email_message" class="text-dark form-control" cols=""
                rows="4" placeholder="This message will be sent along with Bill details."></textarea>
            </div>
     
        </div>
        <div class="modal-footer d-flex justify-content-center" style="border-top: 1px solid #ffff;">
          <!-- <button type="submit">submit</button> -->
          <input type="submit" id="share_with_email"
            class="submitShareEmailBtn rounded-pill text-grey w-50 my-4 mx-3" value="SEND MAIL">
        </div>
      </div>
    </form>
    </div>
  </div>
</div>

<!-- history modal -->


<div class="modal fade" id="history">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
        <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #eeeaea;">Transaction History</h5>
        <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #000;">
        
          <table style="background-color: #000; margin-right: 10px; border-radius: 5px;padding-top: 4px;">
            <thead class="text-white">
        
              <tr>
                <th style="color: rgb(250, 247, 242);">Action</th>
                <th style="color: rgb(244, 244, 244);">Date</th>
                  <th style="color: rgb(250, 247, 242);">Name</th>
             
                  
              </tr>
          </thead>
        <tbody style="background-color: black;">
          
          {% for i in latest_item_id %}
        <tr style="background-color: black;" class='clickable-row' data-href=""> 
          <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;padding-top: 6px;padding-left: 6px;padding-bottom: 6px;">{{ i.action }}</td>            
          <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;">{{ i.Date }}</td>
          <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;">{{ i.logindetails.first_name }}&nbsp;{{ i.logindetails.last_name }}</td>
       </tr>
    {% endfor %}
    
      
        </tbody>
          </table>


    </div>
  </div>
</div>
</div>
</div>
<!-- comment modal -->
<div class="modal fade" id="cmnts">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
        <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #fefefe;">Comments</h5>
        <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="{% url 'add_item_comment' selitem.id %}" method="post" class="needs-validation"
            id="share_to_email_form" autocomplete="off">
            {% csrf_token %}
            <div class="form-group">
              <label for="emailIds" style="color: #000;">Enter Comment</label>
              <textarea class="form-control text-dark"  style="color: #000;" name="comment" id="comment" rows="5"
                placeholder="MEnter your comment here" required></textarea>
            </div>
           
     
        </div>
        <div class="modal-footer d-flex justify-content-center" style="border-top: 1px solid #ffff;">
          <!-- <button type="submit">submit</button> -->
          <input type="submit" id="share_with_email"
            class="submitShareEmailBtn rounded-pill text-grey w-50 my-4 mx-3" value="Save">
        </div>
      </div>
    </form>
    </div>
  </div>
</div>


<div class="modal fade" id="cmt_list">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header" style="background: rgb(32, 35, 37);">
        <h5 class="m-3 text-uppercase" id="shareBillEmailLabel" style="color: #eeeaea;">Comments</h5>
        <button type="button" class="close" style="width: 30px;" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3" style="background-color: #000;">
        
          <table style="background-color: #000; margin-right: 10px; border-radius: 5px;">
            <thead class="text-white">
        
              <tr>
                <th style="color: rgb(250, 247, 242);"></th>
                <th style="color: rgb(244, 244, 244);"></th>
         
             
                  
              </tr>
          </thead>
        <tbody style="background-color: rgb(225, 195, 195);width: 200px;">
          
          {% for i in est_comments %}
        <tr style="background-color: black;" class='clickable-row' data-href=""> 
          <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;margin-left: 10px;">{{ i.comments }}</td>            
          <td class="bg-dark text-white" style="color: rgb(0, 0, 0); background-color: black;"><a href="{% url 'delete_item_comment' i.id %}"> <span
            aria-hidden="true">&times;</span></a></td>
          
      </tr>
      <tr></tr>
    {% endfor %}
    
      
        </tbody>
          </table>


    </div>
  </div>
</div>
</div>
</div>
<script>
  function sortTable(columnIndex) {
     const table = document.getElementById("table2");
     const tbody = table.getElementsByTagName('tbody')[0];
     const rows = Array.from(tbody.rows);
 
     rows.sort((row1, row2) => {
         const cellValue1 = row1.cells[columnIndex].textContent.toLowerCase();
         const cellValue2 = row2.cells[columnIndex].textContent.toLowerCase();
 
         if (cellValue1 < cellValue2) {
             return -1;
         } else if (cellValue1 > cellValue2) {
             return 1;
         } else {
             return 0;
         }
     });
 
     while (tbody.firstChild) {
         tbody.removeChild(tbody.firstChild);
     }
 
     rows.forEach(row => tbody.appendChild(row));
 }
 
 
 </script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function() {
    $('#searchInput').on('keyup', function() {
      var searchText = $(this).val().toLowerCase();
      $('#table2 tbody tr').each(function() {
        var itemData = $(this).text().toLowerCase();
        if (itemData.indexOf(searchText) === -1) {
          $(this).hide();
        } else {
          $(this).show();
        }
      });
    });
  });
</script>
  {% endblock %}
