{% extends 'base.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.js"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-xxxxxx" crossorigin="anonymous" />

<div class="body-wrapper" style="margin-left: 0; width: 100%;">

    <div class="container-fluid" style="width: 100%; margin: 0 auto;">

        <div class="col-md-12" style="width: 120%;">
            <div class="row">
              <div class="col-md-3" style="border-right: 1px solid white; overflow-y: scroll; height: 84vh;">
                <div class="row">
                  <a class="text-white" style="font-size: 1.5rem;">All Accounts</a>
               
                  <br>      
                  <div class="col-md-2">
                    <div class="dropdown">
                        <a class="btn text-center mt-2 btn-outline-warning" id="sortbutton" data-bs-toggle="dropdown" role="button" style="margin-left: 0; height: 38px;">
                            <i class="fas fa-sort m-1"></i>
                         </a>
                         
                         <div class="dropdown-menu m-1" style="background-color: black; color: white;">
                            <a class="dropdown-item dropdown-item-all" href="javascript:void(0);" style="background-color: black; color: white;">All</a>
                            <a class="dropdown-item dropdown-item-sort" href="javascript:void(0);" data-column-index="0" style="background-color: black; color: white;">Account Name</a>
               
                          </div>
                      
                    </div>
                  </div>
                  <div class="col-md-3" style="padding-left: 40px;">
                    <div class="col-md-2">
                      <div class="col-md-2  mt-2 mx-1">
                        <a class="btn text-center btn-outline-warning text-warning px-3 fa fa-filter" data-bs-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"></a>

                        <div class="dropdown-menu m-1" style="background-color: black; color: white;">
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">All</a>
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">Assets</a>
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">Liability</a>
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">Equity</a>
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">Income</a>
                            <a class="dropdown-item dropdown-item-filter-account-type" href="javascript:void(0);" style="background-color: black; color: white;">Expense</a>
                          </div>
                        
                      </div>
                    </div>
                        <br>
                  
           
                </div>
                  <div class="col-md-3 " style="padding-left: 40px;">
                    <a class="btn btn btn-outline-warning text-right mt-2" style="height: 38px; padding-top: 12px; padding-left: 17px;" href="{% url 'create_item'%}"><i class="fa fa-plus"></i></a>

                  </div>
                  <div class="col-md-6"></div>
    
                </div>
    
                <div class="scrollable-table" style="width: 100%;">
                  <div class="row">
                    <div class="col-md-12">
                        <input type="text" id="search" placeholder="Search..." class="form-control text-dark bg-light" autocomplete="off">

                    </div>
                </div>
    
           
              
              
              <!-- Table 2: Billable Projects -->
              <table id="table2" class="table customer-table" style="border: 1px solid black; width: 100%; margin-left: 0;">

                <tbody>
                  {%for i in items %}
                  <tr class="account-row" data-account-type="{{ i.account_type }}">
                    <td>
                      <a class="text-white"  href="{% url 'itemsoverview'  i.id%}"><b>{{i.item_name}}</b> <span class="d-flex justify-content-end text-warning align-items-start" > {{i.current_stock}}</span> <br>
                          <span class="d-flex  align-items-start text-warning"> {{i.hsn_code}}</span> <span class="d-flex justify-content-end align-items-start"> {{i.activation_tag}}</span>
                      </a> 
                  </td>
                  </tr>
                  {%endfor%}
                </tbody>
              </table>

    </div>
</div>


<div class="col" style="width: 300%;" id="overviewdiv" >
    <div class="row">
      <div class="col-md-7">
        <a class="text-white" style="font-size: 1.5rem;">
          <h2 style="color: aliceblue;">{{selitem.item_name}}</h2>
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <a class="btn" style="background-color: chocolate; margin-right: 2vh;color: aliceblue;"><i class="fas fa-eye"></i>
          Overview</a>
       
        <!-- <a href=" " class=" btn fa fa-file-alt" data-bs-toggle="dropdown" id="attachmentDropdown"
          aria-haspopup="true" aria-expanded="false"
          style="background-color: white; color: black; margin-right: 2vh;"> Templates
        </a>

        <div class="dropdown-menu" aria-labelledby="attachmentDropdown">
          <a class="dropdown-item" onclick="totemplate()"><i class="fa fa-file-alt"></i> Template 1</a>

          <a class="dropdown-item" onclick="totemplate2()"><i class="fa fa-file-alt"></i>
            Template 2</a>

          <a class="dropdown-item" onclick="totemplate3()"><i class="fa fa-file-alt"></i>
            Template 3</a>


        </div> -->

      </div>

      <div class="col-md-6" style="text-align: center;">

       
        <a href="{% url 'edititems'  selitem.id%}" class="btn btn-outline-warning py-2  text-warning 
        " title="save this draft" ><i class="fas fa-pencil-alt"></i>
    </a>
  <a href=" " class="delete fa fa-trash btn btn-outline-warning text-warning px-2 py-2"
   data-toggle="tooltip" title="DELETE" onclick="return confirm('Do you want to Delete this creditnote?');"> </a>
   
            {% if selacc.Create_status != 'activate' %}
            <a href="" class="btn btn-outline-warning py-2  text-warning 
             " title="save this draft" ><i class="fas fa-save"></i></a>
            {% endif %}
  
     
  
        <a class="text-dark" data-toggle="dropdown">
          <button class="btn btn-outline-warning " title="Share"><i class="fas fa-share"></i></button>
        </a>
        <div class="dropdown-menu ">
          <a class="dropdown-item" data-target="#shareBillEmail" data-toggle="modal">GMAIL</a>
          <a class="dropdown-item" href="javascript:void(0);" onclick="shareOnWhatsApp()">WhatsApp</a>
        </div>
       
        <a class="  text-dark" onclick="exportToPDF3()">
          <button class="btn btn-outline-warning" title="Pdf"><i class="fas fa-file-pdf-o"></i></button>
        </a>
        <a class=" text-dark" onclick="printSelectedArea2()">
          <button class="btn btn-outline-warning" title="Print"><i class="fas fa-print"></i>
          </button>
        </a>
        
          
               
                    <a href=" " class="btn  btn-outline-warning py-2  fas fa-comment-dots dropdown-toggle text-warning "  
                        data-bs-toggle="dropdown" id="attachmentDropdown" aria-haspopup="true" aria-expanded="false"> 
                    </a>

                    <div class="dropdown-menu" aria-labelledby="attachmentDropdown">
                        <a class="dropdown-item" style="cursor: pointer;" data-toggle="modal"
                         data-target="#cmnts"><i class="fa-solid fa fa-plus"></i>Add</a>
                        <a class="dropdown-item" style="cursor: pointer;" data-toggle="modal"
                        data-target="#cmt_list"><i class="fas fa-list"></i>&nbsp;View List</a>
                                
                    </div>
          
   

   
       
            <a href=" " class=" fas fa-paperclip dropdown-toggle btn btn-outline-warning text-warning py-2 "  
                data-bs-toggle="dropdown" id="attachmentDropdown" aria-haspopup="true" aria-expanded="false"> 
            </a>

            <div class="dropdown-menu" aria-labelledby="attachmentDropdown">
                <a class="dropdown-item" style="cursor: pointer;" data-toggle="modal"
                    data-target="#files"><i class="fa fa-paperclip"></i> Attach File</a>
                {% if expense.attachment != "" %}
                <a class="dropdown-item" href=""><i
                        class="fa fa-download"></i> Download File</a>
                {% endif %}
            </div>
    </div>
    </div><br>

    <div class="row" id="div-to-pdf"
      style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">

      <div class="row text-center">
        <h2 style="color: #000000;"><br>{{selitem.item_name}}
          <hr>
        </h2>
      </div>    
      <div class="row" id="div-to-pdf"
      style="background-color: #ffddb0;  height: auto; margin-left:1px; margin-right: 1rem; ">

      
      <div class="gen-info col-6 " style="padding-left: 3rem; ">
        <div class="row mt-1">
          <div class="col-5"><label class="text-dark" for="">Item Type:</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.item_type}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">HSN Code:</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">   {{selitem.hsn_code}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Unit :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              {{selitem.unit}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Tax Preference :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              {{selitem.tax_reference}}</p>
          </div>
        </div>
        {% if selitem.tax_reference == "taxable" %}
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Intrastate Tax :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">
              GST{{selitem.intrastate_tax}}%</p>
          </div>
        </div>
  
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Interstate Tax :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  CGST{{selitem.interstate_tax}}%</p>
          </div>
        </div>
        {% endif %}
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Status :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">         {{selitem.activation_tag}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for=""> Minimum Stock To Maintain :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">        {{selitem.minimum_stock_to_maintain}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Inventory Account : </label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.inventory_account}}</p>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Opening stock :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">{{selitem.opening_stock}}</p>
          </div>
        </div>
      
        <div class="row mt-3">
          <div class="col-5"><label class="text-dark" for="">Current Stock :</label></div>
          <div class="col-7">
            <p class="bold text-dark" style="max-width: 15rem;word-wrap: break-word;">  {{selitem.current_stock}}</p>
          </div>
        </div>
      </div>
     
      
      <div class="p-info col-6 text-white" style="height: 100%; margin-bottom: 1vh;">
        <div class="card text-white" style="background-color: rgb(110, 61, 46); padding-left: 1rem; padding-top: 1rem;">
          <div class="row text-center">
            <h2 class="text-white">PURCHASE DETAILS
              <hr>
            </h2>
          </div>


          <div class="row mt-2 text-white" >
            <div class="col-5"><label for="">Purchase Price :</label></div>
            <div class="col-7">
              <p class="bold"> {{selitem.purchase_price}}</p>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-5"><label for="">Purchase Account :</label></div>
            <div class="col-7">
              <p class="bold">  {{selitem.purchase_account}}  </p>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-5"><label for=""> Purchase Description :</label></div>
            <div class="col-7">
              <p class="bold">  {{selitem.purchase_description}} </p>
            </div>
          </div>

<br>
            
            

   
    <div class="row text-center">
      <h2 class="text-white">SELLING DETAILS
        <hr>
      </h2>
    </div>



      <div class="row mt-2">
        <div class="col-5"><label for=""> Selling Price :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.selling_price}} </p>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-5"><label for=""> Sales Account :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.sales_account}} </p>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-5"><label for=""> Sales Description :</label></div>
        <div class="col-7">
          <p class="bold">  {{selitem.sales_description}} </p>
        </div>
      </div>
</div>
</div>
</div>
    </div>
       
<!-- SORT  AND FILTER SCRIPT -->
<script>
    $(document).ready(function() {
        // Event listener for dropdown menu links
        $('.dropdown-item-filter-account-type').click(function() {
            // Get the selected account type
            var selectedType = $(this).text().toLowerCase();
    
            // Show/hide table rows based on the selected account type
            $('.account-row').each(function() {
                var accountType = $(this).data('account-type').toLowerCase();
                if (selectedType === 'all' || accountType === selectedType) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        });
    });

    $(document).ready(function() {
    // Initialize DataTable
    var table = $('#table2').DataTable({
        "paging": false, // Disable pagination if not needed
        "order": [[0, "asc"]], // Initial sorting by the first column (change as needed)
    });

    // Event listener for dropdown menu links
    $('.dropdown-item-filter-account-type').click(function() {
        // ... (your existing filtering logic)

        // Refresh DataTable after filtering
        table.draw();
    });

    // Event listener for sorting dropdown menu link
    $('.dropdown-item-sort').click(function() {
        var columnIndex = $(this).data('column-index');

        // Toggle between ascending and descending order
        var order = table.order()[0];
        if (order[0] === columnIndex) {
            order[1] = order[1] === 'asc' ? 'desc' : 'asc';
        } else {
            order = [columnIndex, 'asc'];
        }

        // Apply sorting
        table.order(order).draw();
    });
});
    </script>
    
  
{% endblock %}
